package com.cosplay.dataserver.server;

import java.util.HashMap;
import java.util.Map;

import com.cosplay.dataserver.context.DataApplicationContext;
import com.cosplay.dataserver.db.base.interfaces.DbBase;
import com.cosplay.dataserver.db.mongodb.impl.MongodbControlImpl;
import com.cosplay.dataserver.type.DataBaseNameEnum;
import com.mongodb.DB;

/**
 *
 * */
public class DbBasePoolManager {
	private  final Map<DataBaseNameEnum,DbBase> dbContext = new HashMap<DataBaseNameEnum,DbBase>();
	private static DbBasePoolManager dbBasePoolManager = new DbBasePoolManager();
	private DbBasePoolManager(){
		init();
	}
	private void init(){
		this.dbContext.clear();
		/*dbContext.put(DataApplicationContext.getinstance().MYSQL, new MysqlControlImpl());*/
		this.dbContext.put(DataApplicationContext.getInstance().MONGODB,MongodbControlImpl.getInstance());
	}
	private DbBase getDbFromPool(DataBaseNameEnum DbName){
		return this.dbContext.get(DbName);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
	}
	public static final DbBasePoolManager getInstance(){
		return dbBasePoolManager;
	}
	public DB getMongoDb(){
		MongodbControlImpl mc = (MongodbControlImpl) DbBasePoolManager.getInstance().getDbFromPool(DataApplicationContext.getInstance().MONGODB);		
		return  mc.getDb();
	}
	public DB getMongoDb(String dbName){
		MongodbControlImpl mc = (MongodbControlImpl) DbBasePoolManager.getInstance().getDbFromPool(DataApplicationContext.getInstance().MONGODB);		
		return  mc.getDb(dbName);
	}
	
}
